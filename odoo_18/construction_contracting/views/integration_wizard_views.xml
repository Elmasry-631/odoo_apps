<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <!-- =======================
       1) Wizard FORM VIEWS
       ======================= -->

  <!-- MS Project Wizard -->
  <record id="view_import_msp_wizard" model="ir.ui.view">
    <field name="name">import.msp.wizard.form</field>
    <field name="model">import.msp.wizard</field>
    <field name="arch" type="xml">
      <form string="استيراد MS Project (XML)">
        <sheet>
          <group>
            <field name="file" filename="filename"/>
            <field name="filename" readonly="1"/>
          </group>
          <footer>
            <button string="استيراد" name="action_import" type="object" class="btn-primary"/>
            <button string="إلغاء" class="btn-secondary" special="cancel"/>
          </footer>
        </sheet>
      </form>
    </field>
  </record>

  <!-- Primavera P6 Wizard -->
  <record id="view_import_p6_wizard" model="ir.ui.view">
    <field name="name">import.p6.wizard.form</field>
    <field name="model">import.p6.wizard</field>
    <field name="arch" type="xml">
      <form string="استيراد Primavera P6 (XML)">
        <sheet>
          <group>
            <field name="project_id" required="1" options="{'no_open': True}"/>
            <field name="prefix_code_in_name"/>
            <field name="import_relationships"/>
          </group>
          <group string="ملف الاستيراد">
            <field name="file" filename="filename"/>
            <field name="filename" readonly="1"/>
          </group>
          <footer>
            <button string="استيراد" name="action_import" type="object" class="btn-primary"/>
            <button string="إلغاء" special="cancel" class="btn-secondary"/>
          </footer>
        </sheet>
      </form>
    </field>
  </record>

  <!-- IFC Wizard -->
  <record id="view_import_ifc_wizard" model="ir.ui.view">
    <field name="name">import.ifc.wizard.form</field>
    <field name="model">import.ifc.wizard</field>
    <field name="arch" type="xml">
      <form string="استيراد BIM (IFC/IFCXML)">
        <sheet>
          <group>
            <field name="project_id" required="1" options="{'no_open': True}"/>
            <field name="quantity_key"/>
          </group>
          <group string="ملف الاستيراد">
            <field name="file" filename="filename"/>
            <field name="filename" readonly="1"/>
          </group>
          <footer>
            <button string="استيراد" name="action_import" type="object" class="btn-primary"/>
            <button string="إلغاء" special="cancel" class="btn-secondary"/>
          </footer>
        </sheet>
      </form>
    </field>
  </record>

  <!-- ===================================
       2) Actions (ir.actions.act_window)
       =================================== -->

  <!-- MSP -->
  <record id="action_import_msp_wizard" model="ir.actions.act_window">
    <field name="name">استيراد MS Project (XML)</field>
    <field name="res_model">import.msp.wizard</field>
    <field name="view_mode">form</field>
    <field name="view_id" ref="view_import_msp_wizard"/>
    <field name="target">new</field>
    <field name="binding_model_id" ref="project.model_project_project"/>
    <field name="binding_view_types">form</field>
    <field name="context">{'default_project_id': context.get('active_id')}</field>
    <field name="groups_id" eval="[(4, ref('base.group_user'))]"/>
  </record>

  <!-- P6 -->
  <record id="action_import_p6_wizard" model="ir.actions.act_window">
    <field name="name">استيراد Primavera P6 (XML)</field>
    <field name="res_model">import.p6.wizard</field>
    <field name="view_mode">form</field>
    <field name="view_id" ref="view_import_p6_wizard"/>
    <field name="target">new</field>
    <field name="binding_model_id" ref="project.model_project_project"/>
    <field name="binding_view_types">form</field>
    <field name="context">{'default_project_id': context.get('active_id')}</field>
    <field name="groups_id" eval="[(4, ref('base.group_user'))]"/>
  </record>

  <!-- IFC -->
  <record id="action_import_ifc_wizard" model="ir.actions.act_window">
    <field name="name">استيراد BIM (IFC/IFCXML)</field>
    <field name="res_model">import.ifc.wizard</field>
    <field name="view_mode">form</field>
    <field name="view_id" ref="view_import_ifc_wizard"/>
    <field name="target">new</field>
    <field name="binding_model_id" ref="project.model_project_project"/>
    <field name="binding_view_types">form</field>
    <field name="context">{'default_project_id': context.get('active_id')}</field>
    <field name="groups_id" eval="[(4, ref('base.group_user'))]"/>
  </record>

  <!-- =========================================================
       3) أزرار في شاشة المشروع (inherit) لفتح الويزردات
       ========================================================= -->
  <record id="project_form_inherit_import_buttons" model="ir.ui.view">
    <field name="name">project.project.form.integrations.buttons</field>
    <field name="model">project.project</field>
    <field name="inherit_id" ref="project.edit_project"/>
    <field name="arch" type="xml">
      <header position="inside">
        <button string="استيراد MSP" type="action"
                name="%(construction_contracting.action_import_msp_wizard)d"
                class="btn-secondary"
                context="{'default_project_id': context.get('active_id', id)}"
                groups="base.group_user"/>
        <button string="استيراد P6" type="action"
                name="%(construction_contracting.action_import_p6_wizard)d"
                class="btn-secondary"
                context="{'default_project_id': context.get('active_id', id)}"
                groups="base.group_user"/>
        <button string="استيراد IFC" type="action"
                name="%(construction_contracting.action_import_ifc_wizard)d"
                class="btn-secondary"
                context="{'default_project_id': context.get('active_id', id)}"
                groups="base.group_user"/>
      </header>
    </field>
  </record>



</odoo>
